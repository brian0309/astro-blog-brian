

---
import HeaderLink from './HeaderLink.astro';
import ThemeToggle from './ThemeToggle.jsx';
import SidebarOverlay from './SidebarOverlay.jsx';
---

<script>
  // Client-side code
  let open = false;

  function handleOpen(e) {
    if (e.detail && e.detail.type === 'open-sidebar') {
      open = true;
      document.getElementById('mobile-sidebar').classList.remove('translate-x-full');
      document.getElementById('sidebar-overlay').classList.remove('hidden');
    }
  }

  function closeSidebar() {
    open = false;
    document.getElementById('mobile-sidebar').classList.add('translate-x-full');
    document.getElementById('sidebar-overlay').classList.add('hidden');
  }

  // Add event listeners after DOM is loaded
  document.addEventListener('DOMContentLoaded', () => {
    window.addEventListener('open-sidebar', handleOpen);
    
    // Add click handler to overlay
    const overlay = document.getElementById('sidebar-overlay');
    if (overlay) {
      overlay.addEventListener('click', closeSidebar);
    }
  });
</script>

<!-- Sidebar Overlay -->
<div id="sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-30 z-40 hidden" aria-label="Close sidebar overlay" tabindex="-1" role="presentation"></div>

<!-- Sidebar -->
<aside
  id="mobile-sidebar"
  class="fixed inset-y-0 right-0 w-64 bg-white bg-opacity-100 dark:bg-gray-900 dark:bg-opacity-100 border-l border-gray-200 dark:border-gray-800 shadow-lg transform transition-transform duration-300 ease-in-out z-50 translate-x-full"
>
  <div class="p-4 flex flex-col h-full">
    <div class="flex-1 flex flex-col gap-4 pt-8">
      <HeaderLink href="/" class="text-lg">Home</HeaderLink>
      <HeaderLink href="/blog" class="text-lg">Blog</HeaderLink>
      <HeaderLink href="/about" class="text-lg">About</HeaderLink>
    </div>
    <div class="pb-8">
      <ThemeToggle client:load />
    </div>
  </div>
</aside>
